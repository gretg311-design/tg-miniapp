<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>Mini App</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>

<body style="background:#0b0b0b;color:#00ff88;font-family:monospace">
  <h3 id="status">üîÑ –ü—Ä–æ–≤–µ—Ä–∫–∞ Telegram‚Ä¶</h3>

  <script>
    const status = document.getElementById("status");

    if (!window.Telegram || !Telegram.WebApp) {
      status.innerText = "‚ùå –ù–µ Telegram —Å—Ä–µ–¥–∞";
    } else {
      const tg = Telegram.WebApp;
      tg.ready();

      fetch("/api/auth", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ initData: tg.initData })
      })
      .then(r => r.json())
      .then(data => {
        if (!data.ok) {
          status.innerText = "‚ùå –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ Telegram";
          return;
        }

        status.innerText =
          "‚úÖ Mini App —Ä–∞–±–æ—Ç–∞–µ—Ç\n" +
          "Telegram ID: " + data.user_id;
      })
      .catch(err => {
        status.innerText = "‚ùå –°–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω";
        console.error(err);
      });
    }
  </script>
</body>
</html>
