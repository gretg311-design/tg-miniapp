<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Anime AI 18+</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root { --purple: #a020f0; --border: #301934; --dark: #000; }
        body { background: var(--dark); color: white; font-family: 'Segoe UI', sans-serif; margin: 0; padding: 15px; }
        
        /* –ö–ê–†–¢–û–ß–ö–ê –ö–ê–ö –ù–ê –°–ö–†–ò–ù–ï */
        .profile-card {
            border: 1px solid var(--border);
            border-radius: 25px;
            padding: 20px;
            margin-bottom: 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(16, 5, 25, 0.5);
        }
        .user-name { font-style: italic; font-weight: bold; font-size: 18px; }
        .user-id { font-size: 13px; color: #888; margin-top: 5px; }
        .balance { color: var(--purple); font-weight: bold; font-size: 18px; display: flex; align-items: center; gap: 5px; }

        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .btn {
            background: transparent;
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 30px 10px;
            text-align: center;
            text-transform: uppercase;
            font-weight: bold;
            font-size: 11px;
            letter-spacing: 1px;
        }
        .btn.boss-btn { border-color: var(--border); }
        .btn.console-btn { border-color: #ff0000; color: #ff0000; }

        .nav-bar {
            position: fixed;
            bottom: 20px;
            width: calc(100% - 30px);
            display: flex;
            justify-content: space-around;
            padding-top: 15px;
            border-top: 1px solid var(--border);
        }
        .nav-item { font-weight: bold; font-size: 14px; text-transform: uppercase; cursor: pointer; }
    </style>
</head>
<body>
    <div id="u-card" class="profile-card">
        <div>
            <div id="u-name" class="user-name">–ó–ê–ì–†–£–ó–ö–ê...</div>
            <div id="u-id" class="user-id">ID: --------</div>
        </div>
        <div class="balance">üåô <span id="u-bal">0</span></div>
    </div>

    <div class="grid">
        <div class="btn">–ß–∞—Ç—ã</div><div class="btn">–ü–µ—Ä—Å–æ–Ω–∞–∂–∏</div>
        <div class="btn">–ï–∂–µ–¥–Ω–µ–≤–∫–∞</div><div class="btn">–ó–∞–¥–∞–Ω–∏—è</div>
        <div class="btn">–ú–∞–≥–∞–∑–∏–Ω</div><div class="btn">–ü—Ä–æ–º–æ–∫–æ–¥—ã</div>
        <div class="btn">–ü—Ä–æ—Ñ–∏–ª—å</div><div class="btn">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</div>
        <div class="btn boss-btn" id="adm" style="display:none">–ê–¥–º–∏–Ω–∫–∞</div>
        <div class="btn console-btn" id="con" style="display:none">–ö–æ–Ω—Å–æ–ª—å</div>
    </div>

    <div class="nav-bar">
        <div class="nav-item">üè† –î–û–ú–û–ô</div>
        <div class="nav-item">‚óÄ –ù–ê–ó–ê–î</div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();
        const userId = tg.initDataUnsafe?.user?.id || 8287041036;
        const userName = tg.initDataUnsafe?.user?.first_name || "User";

        function load() {
            fetch('/api/auth', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({ tgId: userId })
            })
            .then(r => r.json())
            .then(data => {
                if(data.isNew) {
                    fetch('/api/register', {
                        method: 'POST',
                        headers: {'Content-Type': 'application/json'},
                        body: JSON.stringify({ tgId: userId, name: userName, gender: '–ú—É–∂—Å–∫–æ–π' })
                    }).then(r => r.json()).then(u => render(u));
                } else {
                    render(data);
                }
            }).catch(e => {
                document.getElementById('u-name').innerText = "–û–®–ò–ë–ö–ê –°–ï–†–í–ï–†–ê";
            });
        }

        function render(user) {
            document.getElementById('u-name').innerHTML = `${user.name} ${user.role === 'owner' ? '(BOSS)' : ''}`;
            document.getElementById('u-id').innerText = `ID: ${user.tgId}`;
            document.getElementById('u-bal').innerText = user.balance;
            if(user.role === 'owner' || user.role === 'admin') document.getElementById('adm').style.display = 'block';
            if(user.role === 'owner') document.getElementById('con').style.display = 'block';
        }
        load();
    </script>
</body>
</html>
