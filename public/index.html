<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Moon Project - –ñ–µ–ª–µ–∑–æ–±–µ—Ç–æ–Ω</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        /* –ë–ª–æ–∫–∏—Ä—É–µ–º —Å–∏—Å—Ç–µ–º–Ω—ã–µ –∂–µ—Å—Ç—ã —Å–≤–∞–π–ø–∞ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –∑–∞–∫—Ä—ã—Ç–∏—è */
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; -webkit-user-select: none; }
        html, body { 
            background: #05010a; color: white; font-family: sans-serif; margin: 0; 
            overflow: hidden; height: 100vh; width: 100vw; 
            touch-action: none; /* –ó–∞–ø—Ä–µ—Ç —Å–≤–∞–π–ø–æ–≤ –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è */
            overscroll-behavior: none; 
        }
        
        #loading { position: fixed; inset: 0; background: #05010a; z-index: 20000; display: flex; flex-direction: column; align-items: center; justify-content: center; transition: 0.8s ease; }
        .moon-logo { 
            width: 120px; height: 120px; border-radius: 50%; 
            background: radial-gradient(circle, #fff, #888); 
            box-shadow: 0 0 35px #fff;
            animation: pulseMoon 2s infinite ease-in-out; 
        }
        @keyframes pulseMoon {
            0% { transform: scale(1); box-shadow: 0 0 35px #fff; }
            50% { transform: scale(1.05); box-shadow: 0 0 60px #fff; }
            100% { transform: scale(1); box-shadow: 0 0 35px #fff; }
        }
        .disclaimer { position: absolute; top: 20px; right: 20px; color: rgba(255,255,255,0.2); font-size: 10px; text-transform: uppercase; }
        .version { position: fixed; bottom: 10px; left: 50%; transform: translateX(-50%); color: rgba(255,255,255,0.1); font-size: 10px; z-index: 5; }

        #app { padding: 20px; display: none; flex-direction: column; height: 100vh; overflow-y: auto; touch-action: pan-y; padding-bottom: 110px; }
        .u-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 30px; }
        .nick-ultra { font-size: 22px; font-weight: 900; background: linear-gradient(90deg, #bc42f5, #00bcd4, #bc42f5); background-size: 200%; -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        
        .menu-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .menu-item { background: #11081d; border: 1px solid #2d164d; border-radius: 12px; height: 70px; display: flex; align-items: center; justify-content: center; text-transform: uppercase; font-weight: bold; font-size: 10px; color: #fff; cursor: pointer; text-align: center; }
        .btn-adm { border-color: #00bcd4; color: #00bcd4; }
        .btn-con { border-color: #e91e63; color: #e91e63; }

        .overlay { display: none; position: fixed; inset: 0; background: #05010a; z-index: 15000; flex-direction: column; align-items: center; padding: 20px; overflow-y: auto; touch-action: none; }
        .info-card { width: 100%; background: #0d041a; border: 1px solid #2d164d; border-radius: 15px; padding: 15px; margin-bottom: 15px; }
        .term-in { background: #000; border: 1px solid #2d164d; border-radius: 8px; padding: 12px; color: #fff; width: 100%; margin-bottom: 10px; font-size: 14px; }
        .term-btn { background: #1a0b2e; border: 1px solid #e91e63; padding: 15px; border-radius: 10px; text-align: center; width: 100%; color: #fff; text-transform: uppercase; font-weight: bold; margin-bottom: 10px; cursor: pointer; }
        
        .slider-wrap { margin-bottom: 20px; width: 100%; }
        .slider { width: 100%; height: 6px; border-radius: 5px; background: #2d164d; appearance: none; outline: none; }
        .slider::-webkit-slider-thumb { appearance: none; width: 18px; height: 18px; border-radius: 50%; background: #bc42f5; cursor: pointer; border: 2px solid #fff; }
        .setting-label { display: block; margin-bottom: 8px; font-size: 12px; color: #888; text-transform: uppercase; }
    </style>
</head>
<body>
    <div id="loading">
        <div class="disclaimer">–í—Å–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∏ –≤—ã–º—ã—à–ª–µ–Ω—ã</div>
        <div class="moon-logo"></div>
        <div style="margin-top:20px; letter-spacing: 2px; font-size: 12px; color: #fff;">–ó–ê–ì–†–£–ó–ö–ê –ú–ò–†–ê...</div>
    </div>

    <div class="version">v1.0.6 - STABLE</div>

    <div id="app">
        <div class="u-header">
            <div><div id="u-name" class="nick-ultra">...</div><div style="font-size:12px; color:#555;">ID: <span id="u-id">0</span></div></div>
            <div style="font-size: 22px; font-weight: bold;">üåô <span id="shards-balance">0</span></div>
        </div>
        <div class="menu-grid">
            <div class="menu-item" onclick="tg.showAlert('–í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ')">–ß–∞—Ç—ã</div>
            <div class="menu-item" onclick="tg.showAlert('–í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ')">–ü–µ—Ä—Å–æ–Ω–∞–∂–∏</div>
            <div class="menu-item" onclick="tg.showAlert('–í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ')">–ï–∂–µ–¥–Ω–µ–≤–∫–∞</div>
            <div class="menu-item" onclick="tg.showAlert('–≠–∫—Ä–∞–Ω –∑–∞–¥–∞–Ω–∏–π –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ')">–ó–∞–¥–∞–Ω–∏—è</div>
            <div class="menu-item" onclick="tg.showAlert('–í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ')">–ú–∞–≥–∞–∑–∏–Ω</div>
            <div class="menu-item" onclick="tg.showAlert('–í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ')">–ü—Ä–æ–º–æ–∫–æ–¥—ã</div>
            <div class="menu-item" onclick="openPanel('p-profile')">–ü—Ä–æ—Ñ–∏–ª—å</div>
            <div class="menu-item" onclick="openPanel('p-settings')">–ù–∞—Å—Ç—Ä–æ–π–∫–∞</div>
            <div class="menu-item btn-adm" id="nav-adm" style="display:none;" onclick="openPanel('p-adm')">–ê–¥–º–∏–Ω–∫–∞</div>
            <div class="menu-item btn-con" id="nav-con" style="display:none;" onclick="openPanel('p-con')">–ö–æ–Ω—Å–æ–ª—å</div>
        </div>
    </div>

    <div id="p-settings" class="overlay">
        <h2 style="color:#bc42f5">–ù–ê–°–¢–†–û–ô–ö–ò</h2>
        <div class="info-card" style="touch-action: pan-y;">
            <span class="setting-label">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</span>
            <input type="text" id="set-nick" class="term-in" placeholder="–í–∞—à–µ –∏–º—è">
            
            <span class="setting-label">–ü–æ–ª</span>
            <select id="set-gender" class="term-in">
                <option value="male">–ú—É–∂—Å–∫–æ–π</option>
                <option value="female">–ñ–µ–Ω—Å–∫–∏–π</option>
            </select>

            <span class="setting-label">–Ø–∑—ã–∫</span>
            <div class="term-btn" style="padding:10px; font-size:12px;" onclick="tg.showAlert('–í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ')">–†—É—Å—Å–∫–∏–π (–í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)</div>

            <div class="slider-wrap">
                <span class="setting-label">–î–ª–∏–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–π: <b id="val-words">45</b> —Å–ª–æ–≤</span>
                <input type="range" id="set-words" class="slider" min="45" max="100" value="45" oninput="updateSettingsUI()">
            </div>

            <div class="slider-wrap">
                <span class="setting-label">–£—Ä–æ–≤–µ–Ω—å –ø–æ—à–ª–æ—Å—Ç–∏: <span id="val-vulgar">üôÇ 0</span></span>
                <input type="range" id="set-vulgar" class="slider" min="0" max="6" value="0" oninput="updateSettingsUI()">
            </div>
            
            <div class="term-btn" style="border-color:#ff00ea; color:#ff00ea;" onclick="troll18()">–ö–û–ù–¢–ï–ù–¢ 18+</div>
        </div>
        <div class="term-btn" style="border-color:#00ff00" onclick="saveSettings()">–°–û–•–†–ê–ù–ò–¢–¨</div>
        <div class="term-btn" onclick="back()">–ù–ê–ó–ê–î</div>
    </div>

    <div id="p-con" class="overlay">
        <div class="con-title" style="color:#e91e63; font-size: 24px; font-weight: 900;">CONSOLE</div>
        <div class="menu-grid" style="width:100%; padding:10px;">
            <div class="con-btn term-btn" onclick="openPanel('p-con-shards')">–æ—Å–∫–æ–ª–∫–∏</div>
            <div class="con-btn term-btn" onclick="openPanel('p-con-subs')">–ø–æ–¥–ø–∏—Å–∫–∏</div>
        </div>
        <div class="term-btn" onclick="back()">–ó–ê–ö–†–´–¢–¨</div>
    </div>

    <div id="p-adm" class="overlay"><h2>–ê–î–ú–ò–ù –ü–ê–ù–ï–õ–¨</h2><div class="term-btn" onclick="back()">–ù–ê–ó–ê–î</div></div>
    <div id="p-profile" class="overlay"><h2>–ü–†–û–§–ò–õ–¨</h2><div class="info-card" id="profile-content"></div><div class="term-btn" onclick="back()">–ù–ê–ó–ê–î</div></div>

    <script>
        const tg = window.Telegram.WebApp;
        const OID = "8287041036";
        let stack = [];
        let trollCount = 0;

        tg.expand();
        tg.enableClosingConfirmation();

        // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç–∏—è –ø—Ä–∏ —Å–≤–∞–π–ø–∞—Ö
        window.addEventListener('popstate', function (event) {
            if (stack.length > 0) {
                back();
                history.pushState(null, null, window.location.pathname);
            }
        });

        function init() {
            const user = tg.initDataUnsafe?.user || { id: OID, first_name: "Owner" };
            const uid = String(user.id);
            document.getElementById('u-name').innerText = localStorage.getItem('m_nick') || user.first_name;
            document.getElementById('u-id').innerText = uid;
            
            const admins = JSON.parse(localStorage.getItem('m_admins') || "[]");
            if (uid === OID) {
                document.getElementById('shards-balance').innerText = "‚àû";
                document.getElementById('nav-adm').style.display = 'flex';
                document.getElementById('nav-con').style.display = 'flex';
            } else {
                document.getElementById('shards-balance').innerText = localStorage.getItem('m_shards_' + uid) || 0;
                if (admins.includes(uid)) document.getElementById('nav-adm').style.display = 'flex';
            }
            
            updateSettingsUI(true);
            setTimeout(() => { 
                document.getElementById('loading').style.display = 'none'; 
                document.getElementById('app').style.display = 'flex'; 
            }, 1000);
        }

        function updateSettingsUI(isInit = false) {
            const uid = String(tg.initDataUnsafe?.user?.id || OID);
            const sub = (uid === OID) ? "Ultra" : (localStorage.getItem('m_sub_'+uid) || "Free");
            
            const wordsRange = document.getElementById('set-words');
            const vulgarRange = document.getElementById('set-vulgar');

            // 1. –õ–∏–º–∏—Ç—ã –¥–ª–∏–Ω—ã —Å–æ–æ–±—â–µ–Ω–∏–π
            let limitWords = 45;
            if(sub === 'Premium') limitWords = 55;
            if(sub === 'Pro') limitWords = 65;
            if(sub === 'VIP') limitWords = 80;
            if(sub === 'Ultra') limitWords = 100;

            if (parseInt(wordsRange.value) > limitWords) {
                if(!isInit) tg.showAlert(`–õ–∏–º–∏—Ç ${limitWords} —Å–ª–æ–≤ –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è –ø–æ–¥–ø–∏—Å–∫–∏ ${sub}`);
                wordsRange.value = limitWords;
            }

            // 2. –õ–∏–º–∏—Ç—ã –ø–æ—à–ª–æ—Å—Ç–∏
            let vVal = parseInt(vulgarRange.value);
            if(vVal === 5 && !(sub === 'VIP' || sub === 'Ultra')) {
                if(!isInit) tg.showAlert("5 —É—Ä–æ–≤–µ–Ω—å —Ç–æ–ª—å–∫–æ –¥–ª—è VIP –∏ Ultra!");
                vulgarRange.value = 4; vVal = 4;
            }
            if(vVal === 6 && sub !== 'Ultra') {
                if(!isInit) tg.showAlert("6 —É—Ä–æ–≤–µ–Ω—å —Ç–æ–ª—å–∫–æ –¥–ª—è Ultra!");
                vulgarRange.value = 5; vVal = 5;
            }

            document.getElementById('val-words').innerText = wordsRange.value;
            const vLabels = ["üôÇ 0", "üòâ 1", "ü´¢ 2", "üòè 3", "üòç 4", "üíã 5", "ü•µ 6"];
            document.getElementById('val-vulgar').innerText = vLabels[vVal];
        }

        function troll18() {
            trollCount++;
            if(trollCount === 1) tg.showAlert("–ü–æ–ø–∞–ª—Å—è!!! –Ø –µ—â—ë –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ!");
            else { tg.showAlert("–ù–µ —Ç—Ä–æ–≥–∞–π –º–µ–Ω—è, üòí –º–Ω–µ –Ω–µ –ø—Ä–∏—è—Ç–Ω–æ, —Å—Ç–æ–ø"); trollCount = 0; }
        }

        function saveSettings() {
            localStorage.setItem('m_nick', document.getElementById('set-nick').value);
            localStorage.setItem('m_gender', document.getElementById('set-gender').value);
            localStorage.setItem('m_set_words', document.getElementById('set-words').value);
            localStorage.setItem('m_set_vulgar', document.getElementById('set-vulgar').value);
            tg.showAlert("–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ!");
            back();
        }

        function openPanel(id) { 
            stack.push(id); 
            document.getElementById(id).style.display = 'flex'; 
            history.pushState(null, null, window.location.pathname);
        }

        function back() { 
            if(stack.length > 0) document.getElementById(stack.pop()).style.display = 'none'; 
        }

        window.onload = init;
    </script>
</body>
</html>
