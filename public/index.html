<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–õ—É–Ω–Ω—ã–π –ë–æ—Ç</title>
    <style>
        body { background: #05010a; color: #e0d0ff; font-family: sans-serif; margin: 0; }
        .glass { background: rgba(48, 10, 86, 0.6); backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.1); border-radius: 15px; }
        .screen { display: none; padding: 20px; }
        .active { display: block; }
        .nav { position: fixed; bottom: 0; width: 100%; display: flex; justify-content: space-around; background: #0a0212; padding: 15px 0; border-top: 1px solid #333; }
        .btn { padding: 15px; text-align: center; cursor: pointer; margin: 5px; }
    </style>
</head>
<body onload="initApp()">

    <div id="loading-screen" class="active" style="text-align: center; margin-top: 40vh;">
        <h1 style="font-size: 50px;">üåô</h1>
        <p>–ó–∞–≥—Ä—É–∑–∫–∞ —Å–∏—Å—Ç–µ–º—ã...</p>
    </div>

    <div id="reg-screen" class="screen glass" style="margin: 50px 20px;">
        <h2>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è 18+</h2>
        <input type="text" id="reg-name" placeholder="–¢–≤–æ—ë –∏–º—è" style="width: 80%; padding: 10px;">
        <div class="btn glass" onclick="finishReg()">–í–æ–π—Ç–∏</div>
    </div>

    <div id="main-app" class="screen">
        <div class="glass" style="padding: 15px; display: flex; justify-content: space-between;">
            <div><b id="u-name">–ò–º—è</b><br><small id="u-id">ID</small></div>
            <div><span id="u-shards">0</span> üåô</div>
        </div>

        <div id="menu-content" style="margin-top: 20px;">
            <div class="btn glass" onclick="showTab('chat')">–ù–∞—á–∞—Ç—å –æ–±—â–µ–Ω–∏–µ</div>
            <div class="btn glass" onclick="showTab('shop')">–ú–∞–≥–∞–∑–∏–Ω (TON/Stars)</div>
            <div class="btn glass" onclick="showTab('tasks')">–ó–∞–¥–∞–Ω–∏—è (–û—Å–∫–æ–ª–∫–∏)</div>
            <div id="admin-btn" class="btn glass" style="display:none; border-color: gold;">–ê–î–ú–ò–ù –ü–ê–ù–ï–õ–¨</div>
        </div>

        <nav class="nav">
            <span onclick="showTab('chat')">üí¨</span>
            <span onclick="showTab('tasks')">üìã</span>
            <span onclick="showTab('shop')">üíé</span>
            <span onclick="showTab('settings')">‚öôÔ∏è</span>
        </nav>
    </div>

<script>
    const OWNER_ID = "8287041036";
    
    async function initApp() {
        // –ò–º–∏—Ç–∞—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è ID –∏–∑ Telegram
        const urlParams = new URLSearchParams(window.location.search);
        const tgId = urlParams.get('id') || OWNER_ID; // –î–ª—è —Ç–µ—Å—Ç–∞ —Å—Ç–∞–≤–∏–º —Ç–≤–æ–π

        const res = await fetch(`/api/get-user?tgId=${tgId}`);
        const data = await res.json();

        setTimeout(() => {
            document.getElementById('loading-screen').classList.remove('active');
            if (data.exists) {
                renderUser(data.user, tgId);
            } else {
                document.getElementById('reg-screen').classList.add('active');
            }
        }, 2000);
    }

    function renderUser(user, tgId) {
        document.getElementById('main-app').classList.add('active');
        document.getElementById('u-name').innerText = user.name;
        document.getElementById('u-id').innerText = "ID: " + tgId;
        document.getElementById('u-shards').innerText = user.shards;
        
        if (tgId === OWNER_ID) {
            document.getElementById('admin-btn').style.display = 'block';
        }
    }

    function showTab(tab) {
        alert("–ü–µ—Ä–µ—Ö–æ–¥ –≤ —Ä–∞–∑–¥–µ–ª: " + tab);
    }

    // –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è –ø—Ä–∏ —Å–≤–∞–π–ø–µ –≤–Ω–∏–∑
    window.addEventListener('touchmove', (e) => {
        if (window.scrollY === 0 && e.touches[0].pageY > 0) e.preventDefault();
    }, { passive: false });
</script>
</body>
</html>
