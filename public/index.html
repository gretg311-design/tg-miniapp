<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>Anime AI 18+</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    body {
      background: black;
      color: #00ff88;
      font-family: monospace;
      padding: 20px;
    }
  </style>
</head>

<body>

<h3>üîê –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è...</h3>
<pre id="out">–ó–∞–≥—Ä—É–∑–∫–∞...</pre>

<script>
const tg = window.Telegram.WebApp;
tg.ready();

const out = document.getElementById("out");

if (!tg.initData || tg.initData.length === 0) {
  out.textContent = "‚ùå –ù–µ—Ç initData. –û—Ç–∫—Ä–æ–π –º–∏–Ω–∏-–∞–ø–ø –∏–∑ Telegram.";
  throw new Error("NO_INIT_DATA");
}

fetch("/api/auth", {
  method: "POST",
  headers: {
    "Content-Type": "application/json"
  },
  body: JSON.stringify({
    initData: tg.initData
  })
})
.then(res => res.json())
.then(data => {
  if (data.error) {
    out.textContent = "‚ùå –û—à–∏–±–∫–∞: " + data.error;
    return;
  }

  out.textContent =
    "‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω\n\n" +
    "ID: " + data.user.id + "\n" +
    "Username: @" + (data.user.username || "‚Äî") + "\n" +
    "Premium: " + (data.user.is_premium ? "YES" : "NO");
})
.catch(err => {
  out.textContent = "‚ùå JS –æ—à–∏–±–∫–∞: " + err.message;
});
</script>

</body>
</html>
