<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>Anime AI</title>

  <!-- Telegram Mini App SDK -->
  <script src="https://telegram.org/js/telegram-web-app.js"></script>

  <style>
    body {
      margin: 0;
      background: #0b0b0f;
      color: #ffffff;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      overflow: hidden;
    }

    /* ===== –ó–ê–ì–†–£–ó–ö–ê ===== */
    #loading-screen {
      position: fixed;
      inset: 0;
      background: radial-gradient(circle at top, #1a1a2e, #07070b);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 9999;
    }

    .loader {
      width: 44px;
      height: 44px;
      border: 3px solid rgba(255,255,255,.15);
      border-top: 3px solid #8b5cf6;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin-bottom: 18px;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .loading-text {
      font-size: 15px;
      opacity: .9;
    }

    .fiction-note {
      position: fixed;
      right: 10px;
      bottom: 8px;
      font-size: 11px;
      opacity: 0.45;
      user-select: none;
      pointer-events: none;
    }

    /* ===== –û–°–ù–û–í–ù–û–ï –ú–ï–ù–Æ ===== */
    #app {
      display: none;
      height: 100vh;
      padding: 18px;
      box-sizing: border-box;
    }

    h1 {
      margin-top: 0;
      font-size: 22px;
      font-weight: 600;
    }

    .menu {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 14px;
      margin-top: 20px;
    }

    .btn {
      background: linear-gradient(135deg, #8b5cf6, #6366f1);
      border: none;
      border-radius: 14px;
      padding: 18px;
      color: white;
      font-size: 15px;
      font-weight: 500;
      text-align: center;
      cursor: pointer;
      box-shadow: 0 6px 20px rgba(0,0,0,.35);
    }

    .btn.secondary {
      background: #1f1f2e;
    }

    .admin {
      background: linear-gradient(135deg, #ef4444, #b91c1c);
    }
  </style>
</head>

<body>

<!-- ===== –≠–ö–†–ê–ù –ó–ê–ì–†–£–ó–ö–ò ===== -->
<div id="loading-screen">
  <div class="loader"></div>
  <div class="loading-text">–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è‚Ä¶</div>
  <div class="fiction-note">–í—Å–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∏ —è–≤–ª—è—é—Ç—Å—è –≤—ã–º—ã—à–ª–µ–Ω–Ω—ã–º–∏</div>
</div>

<!-- ===== –û–°–ù–û–í–ù–û–ï –ü–†–ò–õ–û–ñ–ï–ù–ò–ï ===== -->
<div id="app">
  <h1>–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é</h1>

  <div id="user-info"></div>

  <div class="menu">
    <div class="btn">–ü—Ä–æ—Ñ–∏–ª—å</div>
    <div class="btn">–ü–µ—Ä—Å–æ–Ω–∞–∂–∏</div>
    <div class="btn">–ß–∞—Ç—ã</div>
    <div class="btn">–ú–∞–≥–∞–∑–∏–Ω</div>
    <div class="btn secondary">–ü–æ–¥–ø–∏—Å–∫–∞</div>
    <div class="btn secondary">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</div>
    <div id="admin-btn" class="btn admin" style="display:none">–ê–¥–º–∏–Ω</div>
  </div>
</div>

<script>
  const tg = window.Telegram.WebApp;
  tg.ready();

  fetch("/api/auth", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ initData: tg.initData })
  })
  .then(r => r.json())
  .then(data => {
    if (!data.ok) {
      document.querySelector(".loading-text").innerText = "–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ Telegram";
      return;
    }

    // —Å–∫—Ä—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É
    document.getElementById("loading-screen").remove();

    // –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
    const app = document.getElementById("app");
    app.style.display = "block";

    const user = data.user;

    document.getElementById("user-info").innerHTML = `
      <p>ID: <b>${user.id}</b></p>
      <p>Premium: ${user.is_premium ? "–î–∞" : "–ù–µ—Ç"}</p>
    `;

    // üëë –∞–¥–º–∏–Ω–∫–∞ —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∞–º
    if (user.id === 8287041036 || data.isAdmin) {
      document.getElementById("admin-btn").style.display = "block";
    }
  })
  .catch(() => {
    document.querySelector(".loading-text").innerText = "–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è";
  });
</script>

</body>
</html>
