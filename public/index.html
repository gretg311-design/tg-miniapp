<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Anime AI 18+</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
*{margin:0;padding:0;box-sizing:border-box}
body{
  font-family:system-ui;
  background:#0b0614;
  color:#fff;
}
header{
  padding:16px;
  background:#120a24;
  display:flex;
  justify-content:space-between;
}
.balance{color:#e0c8ff}
main{padding:16px;padding-bottom:120px}
.card{
  background:linear-gradient(145deg,#1b0f33,#0e071b);
  border-radius:16px;
  padding:16px;
  margin-bottom:16px;
}
.btn{
  width:100%;
  padding:14px;
  border-radius:14px;
  border:none;
  font-size:16px;
  margin-top:10px;
}
.primary{
  background:linear-gradient(90deg,#7b3fe4,#a56bff);
  color:white;
}
.disabled{
  background:#2b1c4d;
  color:#777;
}
.badge{
  display:inline-block;
  padding:4px 8px;
  border-radius:8px;
  background:#311c5e;
  font-size:12px;
  margin-top:6px;
}
</style>
</head>

<body>

<header>
  <div>üåô Anime AI 18+</div>
  <div class="balance">
    <span id="subName">Free</span> ¬∑
    üåô <span id="balance">0</span>
  </div>
</header>

<main>

<!-- DAILY -->
<div class="card">
  <h2>üéÅ –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è –Ω–∞–≥—Ä–∞–¥–∞</h2>
  <p id="dailyText">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
  <button id="dailyBtn" class="btn primary">–ü–æ–ª—É—á–∏—Ç—å</button>
</div>

<!-- SUBS -->
<div class="card">
  <h2>üëë –ü–æ–¥–ø–∏—Å–∫–∞</h2>
  <p id="subInfo"></p>
  <button class="btn primary" onclick="buySub()">–ö—É–ø–∏—Ç—å / –ü—Ä–æ–¥–ª–∏—Ç—å</button>
</div>

</main>

<script>
const tg = Telegram.WebApp;
tg.ready();

// ---------- –ö–û–ù–§–ò–ì ----------
const SUBS = {
  free:   {name:"Free",    daily:15},
  premium:{name:"Premium",daily:30},
  pro:    {name:"Pro",     daily:50},
  vip:    {name:"VIP",     daily:150},
  ultra:  {name:"Ultra",  daily:200},
};

const DAY = 86400000;

// ---------- –î–ê–ù–ù–´–ï ----------
let balance = Number(localStorage.getItem("balance")) || 50;
let sub = localStorage.getItem("sub") || "free";
let subUntil = Number(localStorage.getItem("subUntil")) || 0;
let lastDaily = Number(localStorage.getItem("lastDaily")) || 0;
let streak = Number(localStorage.getItem("streak")) || 0;

// ---------- UI ----------
const balanceEl = document.getElementById("balance");
const subNameEl = document.getElementById("subName");
const dailyText = document.getElementById("dailyText");
const dailyBtn = document.getElementById("dailyBtn");
const subInfo = document.getElementById("subInfo");

// ---------- –ü–û–î–ü–ò–°–ö–ê ----------
function checkSub(){
  if(sub !== "free" && Date.now() > subUntil){
    sub = "free";
    localStorage.setItem("sub","free");
  }
}
checkSub();

subNameEl.innerText = SUBS[sub].name;
balanceEl.innerText = balance;

subInfo.innerHTML = `
–¢–µ–∫—É—â–∞—è: <b>${SUBS[sub].name}</b><br>
–ï–∂–µ–¥–Ω–µ–≤–∫–∞: <b>${SUBS[sub].daily}</b><br>
${sub !== "free" ? "–î–µ–π—Å—Ç–≤—É–µ—Ç –¥–æ: "+new Date(subUntil).toLocaleDateString() : ""}
`;

// ---------- DAILY ----------
function updateDaily(){
  const diff = Date.now() - lastDaily;
  if(diff >= DAY){
    dailyText.innerText = `–î–æ—Å—Ç—É–ø–Ω–æ ¬∑ –°—Ç—Ä–∏–∫: ${streak}`;
    dailyBtn.disabled = false;
    dailyBtn.className = "btn primary";
  } else {
    const h = Math.ceil((DAY-diff)/3600000);
    dailyText.innerText = `–ß–µ—Ä–µ–∑ ${h} —á`;
    dailyBtn.disabled = true;
    dailyBtn.className = "btn disabled";
  }
}

dailyBtn.onclick = ()=>{
  const now = Date.now();
  if(now-lastDaily < DAY) return;

  streak = (now-lastDaily < DAY*2) ? streak+1 : 1;

  let reward = SUBS[sub].daily;
  if(streak >= 7) reward *= 2;

  balance += reward;
  lastDaily = now;

  localStorage.setItem("balance",balance);
  localStorage.setItem("lastDaily",lastDaily);
  localStorage.setItem("streak",streak);

  balanceEl.innerText = balance;
  updateDaily();
  alert(`üéâ +${reward} –æ—Å–∫–æ–ª–∫–æ–≤`);
};

updateDaily();

// ---------- –ü–û–ö–£–ü–ö–ê (–ó–ê–ì–õ–£–®–ö–ê) ----------
function buySub(){
  alert(
`üíé –ü–æ–¥–ø–∏—Å–∫–∏:
Premium / Pro / VIP / Ultra

–ü–æ–∫—É–ø–∫–∞ –∑–∞ ‚≠ê –∏–ª–∏ TON
(–ø–æ–¥–∫–ª—é—á–∏–º –ø–æ–∑–∂–µ)`
  );
}
</script>

</body>
</html>
