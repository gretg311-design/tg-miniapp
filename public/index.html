<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<title>Anime RP AI</title>

<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
body {
  background:black;
  color:#00ff88;
  font-family:monospace;
  text-align:center;
}
.hidden { display:none; }
button {
  margin:6px;
  padding:10px 14px;
  background:#111;
  border:1px solid #00ff88;
  color:#00ff88;
  cursor:pointer;
}
.card {
  border:1px solid #00ff88;
  padding:16px;
  margin:12px;
}
</style>
</head>

<body>

<div id="auth" class="card">
  <h3>ğŸ” ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñâ€¦</h3>
</div>

<div id="menu" class="card hidden">
  <h2>ğŸŒ™ Ğ“Ğ»Ğ°Ğ²Ğ½Ğ¾Ğµ Ğ¼ĞµĞ½Ñ</h2>

  <button onclick="openProfile()">ğŸ‘¤ ĞŸÑ€Ğ¾Ñ„Ğ¸Ğ»ÑŒ</button>
  <button onclick="openCharacters()">ğŸ­ ĞŸĞµÑ€ÑĞ¾Ğ½Ğ°Ğ¶Ğ¸</button>
  <button onclick="openShop()">ğŸ’ ĞœĞ°Ğ³Ğ°Ğ·Ğ¸Ğ½</button>

  <div id="adminBtn" class="hidden">
    <button onclick="openAdmin()">ğŸ›  ĞĞ´Ğ¼Ğ¸Ğ½-ĞºĞ¾Ğ½ÑĞ¾Ğ»ÑŒ</button>
  </div>
</div>

<div id="profile" class="card hidden">
  <h3>ğŸ‘¤ ĞŸÑ€Ğ¾Ñ„Ğ¸Ğ»ÑŒ</h3>
  <pre id="profileData"></pre>
</div>

<div id="admin" class="card hidden">
  <h3>ğŸ›  ĞĞ´Ğ¼Ğ¸Ğ½-ĞºĞ¾Ğ½ÑĞ¾Ğ»ÑŒ</h3>
  <p>Ğ’Ñ‹Ğ´Ğ°Ñ‚ÑŒ / Ğ·Ğ°Ğ±Ñ€Ğ°Ñ‚ÑŒ Ğ¿Ñ€ĞµĞ¼Ğ¸ÑƒĞ¼</p>
  <p>ĞĞ°Ğ·Ğ½Ğ°Ñ‡Ğ¸Ñ‚ÑŒ Ğ°Ğ´Ğ¼Ğ¸Ğ½Ğ¾Ğ²</p>
  <p>Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ RP</p>
</div>

<script>
const tg = window.Telegram.WebApp;
tg.ready();

tg.BackButton.show();
tg.BackButton.onClick(showMenu);

fetch("/api/auth", {
  method: "POST",
  headers: { "Content-Type": "application/json" },
  body: JSON.stringify({ initData: tg.initData })
})
.then(r => r.json())
.then(data => {
  if (!data.ok) {
    document.body.innerHTML = "âŒ ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¸";
    return;
  }

  document.getElementById("auth").classList.add("hidden");
  document.getElementById("menu").classList.remove("hidden");

  document.getElementById("profileData").textContent =
    JSON.stringify(data.user, null, 2);

  if (data.isAdmin) {
    document.getElementById("adminBtn").classList.remove("hidden");
  }
});

function showMenu() {
  hideAll();
  document.getElementById("menu").classList.remove("hidden");
}

function openProfile() {
  hideAll();
  document.getElementById("profile").classList.remove("hidden");
}

function openAdmin() {
  hideAll();
  document.getElementById("admin").classList.remove("hidden");
}

function openCharacters() {
  tg.showAlert("ĞŸĞµÑ€ÑĞ¾Ğ½Ğ°Ğ¶Ğ¸ Ğ±ÑƒĞ´ÑƒÑ‚ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ñ‹");
}

function openShop() {
  tg.showAlert("ĞœĞ°Ğ³Ğ°Ğ·Ğ¸Ğ½ Ğ±ÑƒĞ´ĞµÑ‚ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½");
}

function hideAll() {
  ["menu","profile","admin"].forEach(id =>
    document.getElementById(id).classList.add("hidden")
  );
}
</script>

</body>
</html>
