<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        /* –ß–ï–†–ù–´–ô –§–û–ù –°–†–ê–ó–£ */
        html, body {
            background: #000 !important;
            margin: 0; padding: 0;
            width: 100%; height: 100%;
            overflow: hidden;
            color: #fff;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
        }

        /* –õ–£–ù–ê (Splash Screen) */
        #splash {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: #000;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }

        .moon {
            width: 90px;
            height: 90px;
            background: radial-gradient(circle at 30% 30%, #ffffff, #8a2be2 75%);
            border-radius: 50%;
            box-shadow: 0 0 50px #8a2be2;
            animation: pulse 2s infinite ease-in-out;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 0.8; }
            50% { transform: scale(1.1); opacity: 1; box-shadow: 0 0 70px #8a2be2; }
        }

        /* –û–°–ù–û–í–ù–û–ô –ö–û–ù–¢–ï–ù–¢ (–°–∫—Ä—ã—Ç) */
        #app {
            display: none;
            flex-direction: column;
            height: 100vh;
            background: #000;
        }

        .header {
            display: flex;
            justify-content: space-between;
            padding: 40px 20px 10px;
            align-items: center;
        }

        .user-name { color: #b026ff; font-weight: 800; font-size: 19px; }
        .balance { color: #ffa500; font-weight: 700; font-size: 18px; }

        /* –°–ï–¢–ö–ê 2x5 –ö–ê–ö –ù–ê –°–ö–†–ò–ù–ï */
        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: repeat(5, 1fr);
            gap: 12px;
            padding: 15px;
            flex-grow: 1;
        }

        .btn {
            background: rgba(30, 5, 50, 0.6);
            border: 1px solid rgba(138, 43, 226, 0.3);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 12px;
            font-weight: 700;
            text-transform: uppercase;
            cursor: pointer;
            transition: 0.2s;
            height: 100%;
        }

        .btn:active { transform: scale(0.95); background: rgba(138, 43, 226, 0.4); }
        .console-btn { border: 1px solid #ff3b3b; color: #ff3b3b; }

        .footer {
            display: flex;
            justify-content: space-around;
            padding: 20px;
            border-top: 1px solid #222;
        }

        .hidden { display: none !important; }
    </style>
</head>
<body>

    <div id="splash">
        <div class="moon"></div>
    </div>

    <div id="app">
        <div class="header">
            <div class="user-name" id="un">...</div>
            <div class="balance">üåô <span id="sh">0</span></div>
        </div>

        <div class="grid">
            <div class="btn">–ß–ê–¢–´</div>
            <div class="btn">–ü–ï–†–°–û–ù–ê–ñ–ò</div>
            <div class="btn">–ï–ñ–ï–î–ù–ï–í–ö–ê</div>
            <div class="btn">–ó–ê–î–ê–ù–ò–Ø</div>
            <div class="btn">–ú–ê–ì–ê–ó–ò–ù</div>
            <div class="btn">–ü–†–û–ú–û–ö–û–î–´</div>
            <div class="btn">–ü–†–û–§–ò–õ–¨</div>
            <div class="btn">–ù–ê–°–¢–†–û–ô–ö–ò</div>
            <div class="btn" id="adm-btn">–ê–î–ú–ò–ù–ö–ê</div>
            <div class="btn console-btn" id="con-btn">–ö–û–ù–°–û–õ–¨</div>
        </div>

        <div class="footer">
            <div>‚óÄ –ù–ê–ó–ê–î</div>
            <div>üè† –î–û–ú–û–ô</div>
        </div>
    </div>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram SDK –º–æ–º–µ–Ω—Ç–∞–ª—å–Ω–æ
        const tg = window.Telegram.WebApp;
        tg.ready();
        tg.expand();
        tg.enableClosingConfirmation();
        tg.headerColor = '#000000';
        tg.backgroundColor = '#000000';

        const OWNER_ID = "8287041036";

        async function loadData() {
            const myId = tg.initDataUnsafe?.user?.id?.toString() || new URLSearchParams(window.location.search).get('tgId') || OWNER_ID;

            try {
                // –ó–∞–ø—Ä–æ—Å –¥–∞–Ω–Ω—ã—Ö
                const res = await fetch(`/api/get-user?tgId=${myId}`);
                const data = await res.json();

                // –î–∞–µ–º 1.5 —Å–µ–∫ –Ω–∞ –∞–Ω–∏–º–∞—Ü–∏—é –ª—É–Ω—ã
                setTimeout(() => {
                    document.getElementById('splash').style.display = 'none';
                    document.getElementById('app').style.display = 'flex';

                    if (myId === OWNER_ID) {
                        document.getElementById('un').innerText = "–ê–∑—É–º–∏ –ê–π (BOSS)";
                        document.getElementById('sh').innerText = "‚àû";
                    } else if (data.exists) {
                        document.getElementById('un').innerText = data.user.name.toUpperCase();
                        document.getElementById('sh').innerText = data.user.shards;
                        document.getElementById('con-btn').classList.add('hidden');
                    } else {
                        // –ï—Å–ª–∏ –Ω–µ—Ç –≤ –±–∞–∑–µ - –ø—Ä–æ—Å—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º BOSS –¥–ª—è —Ç–µ—Å—Ç–∞
                        document.getElementById('un').innerText = "NEW USER";
                    }
                }, 1500);
            } catch (e) {
                // –î–∞–∂–µ –µ—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä —É–ø–∞–ª, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
                setTimeout(() => {
                    document.getElementById('splash').style.display = 'none';
                    document.getElementById('app').style.display = 'flex';
                }, 1500);
            }
        }

        // –ó–∞–ø—É—Å–∫
        loadData();

        // –ó–∞–ø—Ä–µ—Ç —Å–≤–∞–π–ø–∞ –≤–Ω–∏–∑
        window.addEventListener('touchstart', e => {
            if (e.pageY < 10) e.preventDefault();
        }, {passive: false});
    </script>
</body>
</html>
